<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8">
  <title>Creating your own Nimbus testnet | Nimbus</title>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">    
  <script type="text/javascript">
    document.write("<base href='" + location.protocol + "//" + document.location.host + "' />");
  </script>
  <!-- Canonical links -->
  <link rel="canonical" href="https://nimbus.team/docs/custom-nimbus-testnet.html">
  <!-- Alternative links -->
  
    
      <link rel="alternative" hreflang="en" href="https://nimbus.team/docs/custom-nimbus-testnet.html">
    
  
  <!-- Icon -->
  <meta name="msapplication-TileColor" content="#ff9c00">
  <meta name="msapplication-TileImage" content="/icon/mstile-144x144.png">

  <link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16" />
  <link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32" />

  <link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon-76.png?v=0.0.5">
  <link rel="apple-touch-icon" sizes="120x120" href="/img/apple-touch-icon-120.png?v=0.0.5">
  <link rel="apple-touch-icon" sizes="152x152" href="/img/apple-touch-icon-152.png?v=0.0.5">
  <link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon-180.png?v=0.0.5">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon-1024.png?v=0.0.5">
  <!-- CSS -->
  
<link rel="stylesheet" href="/css/main.min.css">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <!-- RSS -->
  <link rel="alternate" href="/atom.xml" title="Nimbus">
  <meta property="og:image" content="/img/graphic-licensing.png" />
  <meta property="og:title" content="Nimbus, a Lighter Ethereum Client" />
</head>

<body>
  <div id="container">
    
      <div class="header">
    <div class="header-left">
        <a class="logo" href="/"></a>
        <ul class="main-nav">
    <li id="about-header" class="item--to-show"><a href="#about">About</a></li>
    <li><a href="#contribute">Contribute</a></li>
    <li class="item--to-show"><a href="#team">Team</a></li>
    <li class="item--to-show"> <a href="/docs">Overview</a></li>
    <li class="item--to-show"> <a href="https://our.status.im/tag/nimbus/" target="_blank" rel="noopener">News</a> </li>
    <li class="item--to-show"> <a href="https://subscribe.nimbus.team/" target="_blank" rel="noopener">Newsletter</a> </li>
</ul>

    </div>
    <div class="header-right">
        <ul class="header-logos">
            <li class="header-link header-link--tw"><a href="https://twitter.com/ethnimbus" target="_blank"><span class="header-icon"></span><span class="header-link-label"></span></a></li>
            <li class="header-link header-link--gh"><a href="https://github.com/status-im/nimbus" target="_blank"><span class="header-icon"></span><span class="header-link-label"></span></a></li>
            <li class="header-link header-link--gt"><a href="https://gitter.im/status-im/nimbus" target="_blank"><span class="header-icon"></span><span class="header-link-label"></span></a></li>
            <li class="header-link header-link--st"><a href="https://join.status.im/chat/public/nimbus-general" target="_blank"><span class="header-icon"></span><span class="header-link-label"></span></a></li>
        </ul>
    </div>
</div>

<div class="mobile-nav-wrap">
    <div class="mobile-nav-inner">
        <a class="logo" href="/"></a>
        <a class="icon-close mobile-nav-close" href="#"></a>
        <ul class="mobile-nav">
            <li><a href="https://our.status.im/tag/nimbus/" target="_blank" rel="noopener">News</a></li>
            <li><a href="http://subscribe.nimbus.team/" target="_blank" rel="noopener">Newsletter</a></li>
            <li><a href="/overview">Overview</a></li>
            <li class="item--dropdown item--to-show">
              <span>Projects</span>
              <ul class="mobile-sub-nav">
                <li><a href="https://incubate.status.im/" target="_blank" rel="noopener" class="">Incubate</a></li>
                <li><a href="https://nimbus.team/" class="">Nimbus</a></li>
                <li><a href="https://embark.status.im/" target="_blank" rel="noopener" class="">Embark</a></li>
                <li><a href="https://keycard.tech/" target="_blank" rel="noopener" class="">Hardwallet</a></li>
              </ul>
            </li>
            <li><a href="https://status.im/contribute/" target="_blank" rel="noopener" class="">Contribute</a></li>
        </ul>
        <div class="mobile-nav-footer">
            <a href=" https://join.status.im/chat/public/nimbus-general" class="button button--orange">Nimbus Status Chat</a>
        </div>
        <header class="dropdown">
            <nav>
                <ul class="main-nav">
    <li id="about-header" class="item--to-show"><a href="#about">About</a></li>
    <li><a href="#contribute">Contribute</a></li>
    <li class="item--to-show"><a href="#team">Team</a></li>
    <li class="item--to-show"> <a href="/docs">Overview</a></li>
    <li class="item--to-show"> <a href="https://our.status.im/tag/nimbus/" target="_blank" rel="noopener">News</a> </li>
    <li class="item--to-show"> <a href="https://subscribe.nimbus.team/" target="_blank" rel="noopener">Newsletter</a> </li>
</ul>

            </nav>
        </header>
    </div>
</div>

    
    <div class="page-intro wrapper">
  <header class="article-header">
    <h1 class="article-title" itemprop="name">Creating your own Nimbus testnet</h1>
    <a href="https://github.com/status-im/nimbus-site/edit/develop/source/docs/custom-nimbus-testnet.md" target="_blank" rel="noopener" class="article-edit-link" title="Improve this doc">Edit on Github</a>
  </header>
</div>
<div id="content-wrap">
  <div id="content" class="wrapper">
    <div id="content-inner">
      <aside id="sidebar" role="navigation">
  <div class="inner">
    <strong class="sidebar-title">Nimbus</strong><a href="/docs/index.html" class="sidebar-link">What Is Nimbus?</a><a href="/docs/design.html" class="sidebar-link">Design</a><a href="/docs/eth1.html" class="sidebar-link">Execution layer</a><a href="/docs/eth2.html" class="sidebar-link">Consensus layer</a><a href="/docs/fluffy.html" class="sidebar-link">Fluffy</a><a href="/docs/libraries.html" class="sidebar-link">Software Libraries</a><a href="/docs/contributor_guide.html" class="sidebar-link">Contributor Guide</a>
  </div>
</aside>
      <article class="article-container" itemscope itemtype="http://schema.org/Article">
        <div class="article-inner">
          <div class="article">
            <div class="inner">
              <div class="article-content" itemprop="articleBody">
                <h2 id="Building-your-own-Nimbus-testnet" class="article-heading"><a href="#Building-your-own-Nimbus-testnet" class="headerlink" title="Building your own Nimbus testnet"></a>Building your own Nimbus testnet<a class="article-anchor" href="#Building-your-own-Nimbus-testnet" aria-hidden="true"></a></h2><p>All beacon nodes joining your custom testnet MUST be compiled with the same beacon chain constants - i.e. if a node is compiled with 8 slots per epoch, one with 16 slots per epoch will not be compatible with it. With that in mind, let’s do this step of building the basic beacon node binary from within <code>vendor/nim-beacon-chain</code>, and let’s also build the tool that can generate validator keys.</p>
<blockquote>
<p>Note that you need Go 1.12+ installed to build the libp2p Go daemon!</p>
</blockquote>
<p>If you haven’t cloned the beacon chain implementation already, do it now:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/status-im/nim-beacon-chain</span><br><span class="line"><span class="built_in">cd</span> nim-beacon-chain</span><br><span class="line">make update</span><br><span class="line"></span><br><span class="line"><span class="comment"># &gt;&gt;&gt; WINDOWS ONLY &lt;&lt;&lt;</span></span><br><span class="line">make fetch-dlls <span class="comment"># WINDOWS ONLY</span></span><br><span class="line"><span class="comment"># &gt;&gt;&gt; WINDOWS ONLY &lt;&lt;&lt;</span></span><br></pre></td></tr></table></figure>

<p>Then let’s build the binaries of the tools we’ll need.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> NIMFLAGS=<span class="string">"-d:release -d:SECONDS_PER_SLOT=6 -d:SHARD_COUNT=64 -d:SLOTS_PER_EPOCH=64"</span> \</span><br><span class="line">&amp;&amp; make beacon_node validator_keygen</span><br></pre></td></tr></table></figure>

<p>This will place the <code>beacon_node</code> binary and the <code>validator_keygen</code> tool in <code>build/</code> in the current folder.</p>
<p>Let’s generate the folders where the node will store its data and then add the validator keys in there. I picked 500 keys.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir -p <span class="variable">$HOME</span>/testnets/custom-network/data</span><br><span class="line">./build/validator_keygen --totalValidators=500 --outputDir=<span class="string">"<span class="variable">$HOME</span>/testnets/custom-network"</span></span><br></pre></td></tr></table></figure>

<p>This will have placed 500 private key files and 500 public key files into the specified output folder.</p>
<p>Next, let’s have the node generate a testnet for us with all the bells and whistles we might need to have others connect to us.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> NETWORK_DIR=<span class="variable">$HOME</span>/testnets/custom-network &amp;&amp; ./build/beacon_node \</span><br><span class="line">--dataDir=<span class="variable">$NETWORK_DIR</span>/data \</span><br><span class="line">createTestnet \</span><br><span class="line">--networkId=666 \</span><br><span class="line">--validatorsDir=<span class="variable">$NETWORK_DIR</span> \</span><br><span class="line">--totalValidators=500 \</span><br><span class="line">--outputGenesis=<span class="variable">$NETWORK_DIR</span>/genesis.json \</span><br><span class="line">--outputNetwork=<span class="variable">$NETWORK_DIR</span>/custom-network.json \</span><br><span class="line">--bootstrapAddress=$(curl -s ifconfig.me) \</span><br><span class="line">--bootstrapPort=34000 \</span><br><span class="line">--genesisOffset=600</span><br></pre></td></tr></table></figure>

<ul>
<li>We set the home folder of the custom network, pass it to the required params and have it generate the genesis file and the metadata file for others to join us through. </li>
<li>The bootstrap address part is dynamically generated from the ifconfig.me service - you can manually input your public IP address here if you know it or if that service fails to detect it - test with <code>curl -s ifconfig.me</code> on the command line. </li>
<li>The port is optional but recommended so you don’t get some cross-chain noise when accidentally connecting to other nodes on the default port.</li>
<li>The <code>genesisOffset</code> flag sets the time of genesis to some time in the future - in this case 10 minutes. We do this to give everyone who intends to join ample chance to join on genesis time because if they don’t and the chain expects validators to be there and perform their duties, they’ll be seen as offline and penalized and eventually kicked off the beacon chain.</li>
</ul>
<p>Running the above command will result in two new files being created. In my case <code>$HOME/testnets/custom-network/genesis.json</code> and <code>$HOME/testnets/custom-network/custom-network.json</code>.</p>
<p>Because these files that were generated are made for others joining you, we need to make a copy of the <code>custom-network</code> file so that we can launch our node, the bootstrap node.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cp <span class="variable">$HOME</span>/testnets/custom-network/custom-network.json <span class="variable">$HOME</span>/testnets/custom-network/custom-network_boot.json</span><br></pre></td></tr></table></figure>

<p>Then open this new file and delete the <code>bootstrapNodes</code> object, all of it. If you don’t, the node you run will try to connect to a bootstrap node that is effectively its-not-yet-running-self. Without the <code>bootstrapNodes</code> part, the node just <em>runs</em> so others can connect <em>to</em> it.</p>
<p>We are now ready to connect and to share these files with those who would connect to us.</p>
<p>The <code>genesis.json</code> file is the starting state, “block 0” of your testnet beacon chain. It contains the listed validators, initial shufflings, and everything the system needs in order to have the clients connecting to the network build on the same foundation. </p>
<p>The <code>custom-network.json</code> file is the “metadata” file of your new network - it has identified your node, the one this file was generated with - as the bootstrap node and included its enode address under <code>bootstrapNodes</code>, along with the other required data and the root of the genesis. </p>
<p>Let’s run the original node now.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./build/beacon_node --network=<span class="variable">$HOME</span>/testnets/custom-network/custom-network_boot.json --stateSnapshot=<span class="variable">$HOME</span>/testnets/custom-network/genesis.json --tcpPort=34000 --udpPort=34000</span><br></pre></td></tr></table></figure>

<p>You can host <code>custom-network.json</code> and <code>genesis.json</code> on a server somewhere or in a <a href="https://gist.github.com/" target="_blank" rel="noopener">Github Gist</a> so anyone grabbing them will be able to join your network if they execute the command:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./build/beacon_node --network=<span class="variable">$HOME</span>/testnets/custom-network/custom-network.json --stateSnapshot=<span class="variable">$HOME</span>/testnets/custom-network/genesis2.json --tcpPort=34001 --udpPort=34001</span><br></pre></td></tr></table></figure>

<p>Let’s run another node on the same machine where the bootstrap node is running. This requires that we create a new data dir, otherwise it’ll clash with the current node. Execute the following chain of commands:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> DATA_DIR=<span class="variable">$HOME</span>/testnets/custom-testnet/node-1 &amp;&amp; mkdir -p <span class="variable">$DATA_DIR</span>/data &amp;&amp; mkdir -p <span class="variable">$DATA_DIR</span>/validators &amp;&amp; ./build/beacon_node \</span><br><span class="line">--network=<span class="variable">$HOME</span>/testnets/custom-network/custom-network_boot.json \</span><br><span class="line">--stateSnapshot=<span class="variable">$HOME</span>/testnets/custom-network/genesis.json \</span><br><span class="line">--tcpPort=34000 \</span><br><span class="line">--udpPort=34000 \</span><br><span class="line">--dataDir:<span class="variable">$DATA_DIR</span>/data \</span><br><span class="line">--nodename:node1</span><br></pre></td></tr></table></figure>

<p>However, they MUST first build their beacon node with the same parameters you did in the beginning of this setup:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> NIMFLAGS=<span class="string">"-d:release -d:SECONDS_PER_SLOT=6 -d:SHARD_COUNT=64 -d:SLOTS_PER_EPOCH=64"</span> &amp;&amp; make beacon_node</span><br></pre></td></tr></table></figure>

<p>Congrats, you have a custom Nimbus testnet up and running! Host those startup files somewhere, distribute some validator keys, and others can join your testnet!</p>
<p><a href="https://our.status.im/content/images/2019/03/Screenshot-from-2019-03-29-21-25-15.png" target="_blank" rel="noopener"><img src="https://our.status.im/content/images/2019/03/Screenshot-from-2019-03-29-21-25-15.png" alt="Screenshot-from-2019-03-29-21-25-15"></a></p>

              </div>
              <footer class="article-footer">
                <time class="article-footer-updated" datetime="2023-03-28T09:09:08.520Z" itemprop="dateModified">Last updated: 2023-03-28</time>
                <a href="/docs/index.html" class="article-footer-next" title="What Is Nimbus?"><span>Next</span><i class="fa fa-chevron-right"></i></a>
              </footer>
            </div>
          </div>
        </div>
      </article>
    </div>
  </div>
</div>

          <div class="footer footer--global">
        <div class="footer-inner">

              <div class="footer-table">

                <div class="footer-table__column margin-top-15">
                  <p class="footer-header">Social links</p>
                  <ul class="footer-list">
                    <li class="footer-link footer-link--gt"><a href="https://gitter.im/status-im/nimbus" target="_blank"><span class="footer-icon"></span><span class="footer-link-label">Gitter</span></a></li>
                    <li class="footer-link footer-link--tw"><a href="https://twitter.com/ethnimbus" target="_blank"><span class="footer-icon"></span><span class="footer-link-label">Twitter</span></a></li>
                    <li class="footer-link footer-link--dc"><a href="https://discord.gg/XRxWahP" target="_blank"><span class="footer-icon"></span><span class="footer-link-label">Discord</span></a></li>                    
                    <li class="footer-link footer-link--st"><a href="https://join.status.im/chat/public/nimbus-general" target="_blank"><span class="footer-icon"></span><span class="footer-link-label">Status</span></a></li>
                  </ul>
                </div>

                <div class="footer-table__column margin-top-15">
                  <p class="footer-header">More</p>
                  <ul class="footer-list">
                    <li class="footer-link"><a href="https://nimbus.team/docs/" target="_blank">Overview</a></li>
                    <li class="footer-link"><a href="/docs/libraries.html" target="_blank">Github</a></li>
                    <li class="footer-link"><a href="https://news.nimbus.team/" target="_blank">News</a></li>
                    <li class="footer-link"><a href="https://subscribe.nimbus.team/" target="_blank">Newsletter</a></li>
                    <li class="footer-link"><a href="https://etherscan.io/address/0xDeb4A0e8d9a8dB30a9f53AF2dCc9Eb27060c6557" target="_blank">Donate</a></li>                    
                    <li class="footer-link"><a href="https://status.im/privacy-policy/" target="_blank">Privacy Policy</a></li>
                  </ul>
                </div>

                <div class="footer-table__column mobile-margin extend-width">
                  <p class="footer-header status-network"> The Status Network </p> <img src="/img/footer-logo.svg" width="30px" class="status-logo" alt="Status Logo">
                    <ul class="footer-project">
                      <li class="footer-link"><a href="https://status.im/" target="_blank">Status</a></li>
                      <li class="footer-link"><a href="https://keycard.tech/" target="_blank">Keycard</a></li>
                      <li class="footer-link"><a href="https://dap.ps/"  target="_blank">dap.ps</a></li>
                      <li class="footer-link"><a href="https://assemble.fund/" target="_blank">Assemble</a></li>
                      <li class="footer-link"><a href="https://embark.status.im/" class="margin-left" target="_blank">Embark</a></li>                                                               
                      <li class="footer-link"><a href="https://subspace.status.im/" class="margin-left" target="_blank">Subspace</a></li>               
                      <li class="footer-link"><a href="https://vac.dev/" class="margin-left" target="_blank">Vac</a></li>
                  </ul>
                </div>

              </div>
          
        </div>
      </div>

  </div>
  
<script src="/js/main.min.js"></script>


</body>
</html>
